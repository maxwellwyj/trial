/* empty css             *//* empty css                    *//* empty css                  *//* empty css                 */import{a as j,u as S,E as c,r as B,b as v,c as $,w as z,o as w,d as x,e as a,f as N,g as e,h as m,i as p,j as k,k as F,l as M,m as T,n as A,p as D,q as G,s as H,t as h,v as b,x as J,y as K}from"./index-CZK4eSiU.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q="http://big-event-vue-api-t.itheima.net",f=j.create({baseURL:Q,timeout:1e4});f.interceptors.request.use(s=>{const r=S();return r.token&&(s.headers.Authorization=r.token),s},s=>Promise.reject(s));f.interceptors.response.use(s=>s.data.code===0?s:(c.error(s.data.message||"服务异常"),Promise.reject(s.data)),s=>{var r;return((r=s.response)==null?void 0:r.status)===401&&B.push("/login"),c.error(s.response.data.message||"服务异常"),Promise.reject(s)});const W=({username:s,password:r,repassword:n})=>f.post("/api/reg",{username:s,password:r,repassword:n}),X=({username:s,password:r})=>f.post("/api/login",{username:s,password:r}),C=s=>(J("data-v-acd080bb"),s=s(),K(),s),Y=C(()=>k("h1",null,"注册",-1)),Z=C(()=>k("h1",null,"登录",-1)),ee={class:"flex"},se={__name:"LoginPage",setup(s){const r=v(!0),n=v(),o=v({username:"",password:"",repassword:""}),y={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:10,message:"用户名必须是5-10位的字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码必须是6-15位的非空字符",trigger:"blur"}],repassword:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码必须是6-15位的非空字符",trigger:"blur"},{validator:(_,t,d)=>{t!==o.value.password?d(new Error("两次输入密码不一致")):d()},trigger:"blur"}]},U=async()=>{await n.value.validate(),await W(o.value),c.success("注册成功"),r.value=!1},I=S(),q=$(),L=async()=>{await n.value.validate();const _=await X(o.value);I.setToken(_.data.token),c.success("登录成功"),q.push("/")};return z(r,()=>{o.value={username:"",password:"",repassword:""}}),(_,t)=>{const d=F,l=M,i=T,V=A,g=D,E=G,P=H,R=N;return w(),x(R,{class:"login-page"},{default:a(()=>[e(d,{span:12,class:"bg"}),e(d,{span:6,offset:3,class:"form"},{default:a(()=>[r.value?(w(),x(E,{key:0,model:o.value,rules:y,ref_key:"form",ref:n,size:"large",autocomplete:"off"},{default:a(()=>[e(l,null,{default:a(()=>[Y]),_:1}),e(l,{prop:"username"},{default:a(()=>[e(i,{modelValue:o.value.username,"onUpdate:modelValue":t[0]||(t[0]=u=>o.value.username=u),"prefix-icon":m(h),placeholder:"请输入用户名"},null,8,["modelValue","prefix-icon"])]),_:1}),e(l,{prop:"password"},{default:a(()=>[e(i,{modelValue:o.value.password,"onUpdate:modelValue":t[1]||(t[1]=u=>o.value.password=u),"prefix-icon":m(b),type:"password",placeholder:"请输入密码"},null,8,["modelValue","prefix-icon"])]),_:1}),e(l,{porp:"repassword"},{default:a(()=>[e(i,{modelValue:o.value.repassword,"onUpdate:modelValue":t[2]||(t[2]=u=>o.value.repassword=u),"prefix-icon":m(b),type:"password",placeholder:"请输入再次密码"},null,8,["modelValue","prefix-icon"])]),_:1}),e(l,null,{default:a(()=>[e(V,{onClick:U,class:"button",type:"primary","auto-insert-space":""},{default:a(()=>[p(" 注册 ")]),_:1})]),_:1}),e(l,{class:"flex"},{default:a(()=>[e(g,{type:"info",underline:!1,onClick:t[3]||(t[3]=u=>r.value=!1)},{default:a(()=>[p(" ← 返回 ")]),_:1})]),_:1})]),_:1},8,["model"])):(w(),x(E,{key:1,model:o.value,rules:y,ref_key:"form",ref:n,size:"large",autocomplete:"off"},{default:a(()=>[e(l,null,{default:a(()=>[Z]),_:1}),e(l,{prop:"username"},{default:a(()=>[e(i,{modelValue:o.value.username,"onUpdate:modelValue":t[4]||(t[4]=u=>o.value.username=u),"prefix-icon":m(h),placeholder:"请输入用户名"},null,8,["modelValue","prefix-icon"])]),_:1}),e(l,{prop:"passworrd"},{default:a(()=>[e(i,{modelValue:o.value.password,"onUpdate:modelValue":t[5]||(t[5]=u=>o.value.password=u),name:"password","prefix-icon":m(b),type:"password",placeholder:"请输入密码"},null,8,["modelValue","prefix-icon"])]),_:1}),e(l,{class:"flex"},{default:a(()=>[k("div",ee,[e(P,null,{default:a(()=>[p("记住我")]),_:1}),e(g,{type:"primary",underline:!1},{default:a(()=>[p("忘记密码？")]),_:1})])]),_:1}),e(l,null,{default:a(()=>[e(V,{onClick:L,class:"button",type:"primary","auto-insert-space":""},{default:a(()=>[p("登录")]),_:1})]),_:1}),e(l,{class:"flex"},{default:a(()=>[e(g,{type:"info",underline:!1,onClick:t[6]||(t[6]=u=>r.value=!0)},{default:a(()=>[p(" 注册 → ")]),_:1})]),_:1})]),_:1},8,["model"]))]),_:1})]),_:1})}}},ne=O(se,[["__scopeId","data-v-acd080bb"]]);export{ne as default};
